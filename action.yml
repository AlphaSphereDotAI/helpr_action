name: Helpr Action
description: Helpr Action is a GitHub Action that helps AlphaSphere.AI team.
inputs:
  build_container:
    required: false
    description: Build Container
    default: "false"
  build_python:
    required: false
    description: Build Python Package
    default: "false"
  ci_tools:
    required: false
    description: Install CI Tools
    default: "false"
  lint:
    required: false
    description: Lint Code
    default: "false"
  release:
    required: false
    description: Release Mode
    default: "false"
  test:
    required: false
    description: Test Code
    default: "false"
  version:
    required: false
    description: Bump Version
    default: "false"
  is_test:
    required: true
    description: Test Mode
  registry:
    required: false
    description: Registry
  install_source:
    required: false
    description: Source to install from (e.g., PyPI Package or Git source)
  github_token:
    required: false
    description: GitHub Token
  opencode_enabled:
    description: Enable opencode tool
    required: false
    default: "false"
  uv_lock_sync_enabled:
    description: Enable uv lock sync
    required: false
    default: "false"
  opencode_model:
    description: Opencode model to use
    required: false
    default: "opencode/grok-code"
  linter:
    description: Linter to use
    required: false
runs:
  using: composite
  steps:
    - name: Checkout repository
      uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
      with:
        token: ${{ inputs.github_token }}
        fetch-depth: 0
    - name: Install Nix
      uses: cachix/install-nix-action@4e002c8ec80594ecd40e759629461e26c8abed15 # v31.9.0
    - name: Cache
      uses: cachix/cachix-action@0fc020193b5a1fa3ac4575aa3a7d3aa6a35435ad # v16
      with:
        name: devenv
    - name: Install devenv.sh
      run: nix profile install nixpkgs#devenv
      shell: bash
    - name: Build Container
      uses: ./.github/actions/build_container
      if: ${{ inputs.build_container == 'true' }}
      with:
        is_test: ${{ inputs.is_test }}
        registry: ${{ inputs.registry }}
        install_source: ${{ inputs.install_source }}
    - name: Build Python Package
      uses: ./.github/actions/build_python
      if: ${{ inputs.build_python == 'true' }}
    - name: CI Tools
      uses: ./.github/actions/ci_tools
      if: ${{ inputs.ci_tools == 'true' }}
      with:
        opencode_enabled: ${{ inputs.opencode_enabled }}
        uv_lock_sync_enabled: ${{ inputs.uv_lock_sync_enabled }}
        opencode_model: ${{ inputs.opencode_model }}
    - name: Lint Code
      uses: AlphaSphereDotAI/helpr_action/.github/actions/lint@main
      if: ${{ inputs.lint == 'true' }}
      with:
        linter: ${{ inputs.linter }}
    - name: Release Mode
      uses: ./.github/actions/release
      if: ${{ inputs.release == 'true' }}
    - name: Test Mode
      uses: ./.github/actions/test
      if: ${{ inputs.test == 'true' }}
    - name: Bump Version
      uses: ./.github/actions/version
      if: ${{ inputs.version == 'true' }}
